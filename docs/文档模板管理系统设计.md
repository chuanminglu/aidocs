# æ–‡æ¡£æ¨¡æ¿ç®¡ç†ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´7æœˆ4æ—¥  
**æœ€åæ›´æ–°**: 2025å¹´7æœˆ4æ—¥  
**è´Ÿè´£äºº**: AI Assistant  

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 åŠŸèƒ½å®šä½
æ–‡æ¡£æ¨¡æ¿ç®¡ç†ç³»ç»Ÿæ˜¯AIæ–‡æ¡£ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›å¼ºå¤§çš„æ¨¡æ¿åˆ›å»ºã€ç¼–è¾‘ã€ç®¡ç†å’Œåº”ç”¨åŠŸèƒ½ã€‚æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼Œå…·å¤‡ç±»ä¼¼äºç°ä»£æ–‡æ¡£ç¼–è¾‘å™¨çš„ç”¨æˆ·ä½“éªŒã€‚

> **æ–°å¢ï¼šæ”¯æŒWordæ–‡æ¡£ï¼ˆ.docx/.docï¼‰è¯»å–ã€è§£æä¸è½¬æ¢ã€‚Wordæ–‡æ¡£å¯è½¬æ¢ä¸ºMarkdownæ ¼å¼è¿›è¡Œç¼–è¾‘ï¼Œæ”¯æŒä¿å­˜ä¸ºWordæ ¼å¼ã€‚æ‰€æœ‰Wordç›¸å…³åŠŸèƒ½é‡‡ç”¨ç‹¬ç«‹æ¨¡å—å®ç°ï¼Œç¡®ä¿ä¸ä¸»ç¼–è¾‘å™¨é€»è¾‘éš”ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚**

### 1.2 è®¾è®¡ç›®æ ‡
- æä¾›ç›´è§‚çš„å¯è§†åŒ–æ¨¡æ¿ç¼–è¾‘å™¨
- æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ˆMarkdownã€Wordã€HTMLç­‰ï¼‰
- å®ç°æ¨¡æ¿çš„å±‚æ¬¡åŒ–ç®¡ç†å’Œåˆ†ç±»
- æä¾›æ¨¡æ¿å˜é‡å’ŒåŠ¨æ€å†…å®¹æ”¯æŒ
- æ”¯æŒæ¨¡æ¿çš„ç‰ˆæœ¬æ§åˆ¶å’Œåä½œç¼–è¾‘
- **Wordæ–‡æ¡£æ”¯æŒï¼šå®ç°Wordæ–‡æ¡£çš„åªè¯»æµè§ˆã€ç»“æ„åŒ–è§£æã€å¤§çº²å¯¼èˆªã€Markdownè½¬æ¢ä¸Wordæ ¼å¼å¯¼å‡ºã€‚æ‰€æœ‰Wordç›¸å…³åŠŸèƒ½éœ€å°½é‡éš”ç¦»å®ç°ï¼Œé¿å…å½±å“ä¸»ç¼–è¾‘å™¨å’Œå…¶ä»–æ ¼å¼çš„ç»´æŠ¤ã€‚**

## 2. æ ¸å¿ƒåŠŸèƒ½è®¾è®¡

### 2.1 æ¨¡æ¿ç¼–è¾‘å™¨æ¶æ„

> **Wordæ–‡æ¡£æ”¯æŒè¯´æ˜ï¼š**
> - æ”¯æŒWordæ–‡æ¡£ï¼ˆ.docx/.docï¼‰å¯¼å…¥ï¼Œè‡ªåŠ¨è§£æä¸ºMarkdownç»“æ„ã€‚
> - Wordæ–‡æ¡£å¯åœ¨ç¼–è¾‘å™¨ä¸­ä»¥åªè¯»æˆ–è½¬æ¢ä¸ºMarkdownåç¼–è¾‘ã€‚
> - æ”¯æŒå°†ç¼–è¾‘å†…å®¹å¯¼å‡ºä¸ºWordæ ¼å¼ã€‚
> - Wordç›¸å…³è§£æã€è½¬æ¢ã€å¯¼å‡ºç­‰åŠŸèƒ½å…¨éƒ¨é€šè¿‡`core/word_parser.py`ç­‰ç‹¬ç«‹æ¨¡å—å®ç°ï¼Œä¸»ç¼–è¾‘å™¨ä»…é€šè¿‡æ¥å£è°ƒç”¨ï¼Œä¿è¯è§£è€¦ã€‚

#### 2.1.1 ä¸‰é¢æ¿è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡æ¡£æ¨¡æ¿ç¼–è¾‘å™¨                                             ğŸ” æœç´¢ âš™ï¸ è®¾ç½®     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ æ¨¡æ¿ç›®å½•æ ‘   â”‚ ğŸ“‘ æ–‡æ¡£å¤§çº²å¯¼èˆª  â”‚         ğŸ“ å†…å®¹ç¼–è¾‘åŒº         â”‚ ğŸ‘ï¸ é¢„è§ˆåŒº â”‚
â”‚ â”œâ”€ğŸ“‹ å·¥ä½œæ¨¡æ¿   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”œâ”€ğŸ“Š æ—¥æŠ¥    â”‚ â”‚ ğŸ“„ æŠ€æœ¯ç ”ç©¶ç¬”è®°â”‚ â”‚ # æŠ€æœ¯ç ”ç©¶ç¬”è®°æ¨¡æ¿        â”‚ â”‚ â”‚æŠ€æœ¯ç ”ç©¶ â”‚ â”‚
â”‚ â”‚ â”œâ”€ğŸ“ˆ å‘¨æŠ¥    â”‚ â”‚ â”œâ”€ğŸ¯ ç ”ç©¶ç›®æ ‡  â”‚ â”‚ **ä¸»é¢˜**: {topic}         â”‚ â”‚ â”‚ç¬”è®°     â”‚ â”‚
â”‚ â”‚ â””â”€ğŸ“‹ æœˆæŠ¥    â”‚ â”‚ â”œâ”€ğŸ“‹ çŸ¥è¯†æ¡†æ¶  â”‚ â”‚ **æ—¥æœŸ**: {date}          â”‚ â”‚ â”‚ä¸»é¢˜:AI  â”‚ â”‚
â”‚ â”œâ”€ğŸ“š ç ”ç©¶æ¨¡æ¿   â”‚ â”‚ â”‚ â”œâ”€æ ¸å¿ƒæ¦‚å¿µ  â”‚ â”‚                           â”‚ â”‚ â”‚æ—¥æœŸ:... â”‚ â”‚
â”‚ â”‚ â”œâ”€ğŸ“ æŠ€æœ¯    â”‚ â”‚ â”‚ â”œâ”€æŠ€æœ¯æ ˆ    â”‚ â”‚ ## ç ”ç©¶ç›®æ ‡              â”‚ â”‚ â”‚         â”‚ â”‚
â”‚ â”‚ â”œâ”€ğŸ“Š åˆ†æ    â”‚ â”‚ â”‚ â””â”€å·¥å…·é“¾    â”‚ â”‚ - [ ] ç›®æ ‡1              â”‚ â”‚ â”‚ç ”ç©¶ç›®æ ‡ â”‚ â”‚
â”‚ â”‚ â””â”€ğŸ“„ ç¬”è®°    â”‚ â”‚ â”œâ”€ğŸ”¬ å®è·µæ¡ˆä¾‹  â”‚ â”‚ - [ ] ç›®æ ‡2              â”‚ â”‚ â”‚â–¡ ç›®æ ‡1  â”‚ â”‚
â”‚ â”œâ”€ğŸ“Š é¡¹ç›®æ¨¡æ¿   â”‚ â”‚ â”‚ â”œâ”€æ¡ˆä¾‹1     â”‚ â”‚                           â”‚ â”‚ â”‚â–¡ ç›®æ ‡2  â”‚ â”‚
â”‚ â”‚ â”œâ”€ğŸ¯ å¯åŠ¨    â”‚ â”‚ â”‚ â””â”€æ¡ˆä¾‹2     â”‚ â”‚ ## çŸ¥è¯†æ¡†æ¶              â”‚ â”‚ â”‚         â”‚ â”‚
â”‚ â”‚ â”œâ”€ğŸ“‹ å¤ç›˜    â”‚ â”‚ â”œâ”€âœ… æœ€ä½³å®è·µ  â”‚ â”‚ ### æ ¸å¿ƒæ¦‚å¿µ             â”‚ â”‚ â”‚çŸ¥è¯†æ¡†æ¶ â”‚ â”‚
â”‚ â”‚ â””â”€ğŸ“Š çŠ¶æ€    â”‚ â”‚ â”œâ”€â“ é—®é¢˜è§£å†³  â”‚ â”‚ - **æ¦‚å¿µ1**: å®šä¹‰        â”‚ â”‚ â”‚æ ¸å¿ƒæ¦‚å¿µ â”‚ â”‚
â”‚ â””â”€ğŸ”§ è‡ªå®šä¹‰     â”‚ â”‚ â”œâ”€ğŸ”„ è¿›é˜¶æ–¹å‘  â”‚ â”‚ {concept_placeholder}     â”‚ â”‚ â”‚- æ¦‚å¿µ1  â”‚ â”‚
â”‚   â”œâ”€æˆ‘çš„æ¨¡æ¿A   â”‚ â”‚ â”œâ”€ğŸ“š å‚è€ƒèµ„æ–™  â”‚ â”‚                           â”‚ â”‚ â”‚æŠ€æœ¯æ ˆ   â”‚ â”‚
â”‚   â””â”€æˆ‘çš„æ¨¡æ¿B   â”‚ â”‚ â”œâ”€ğŸ’­ ä¸ªäººæ€è€ƒ  â”‚ â”‚ ### æŠ€æœ¯æ ˆ               â”‚ â”‚ â”‚å·¥å…·é“¾   â”‚ â”‚
â”‚                 â”‚ â”‚ â””â”€ğŸ“‹ åç»­è¡ŒåŠ¨  â”‚ â”‚ {tech_stack_placeholder}  â”‚ â”‚ â”‚         â”‚ â”‚
â”‚                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                           â”‚ â”‚ â”‚å®è·µæ¡ˆä¾‹â”‚ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ ğŸ“‹ æ¨¡æ¿å±æ€§     â”‚ ğŸ”§ å¤§çº²æ“ä½œ      â”‚ ğŸ“ æºç  â”‚ ğŸ¨ å¯Œæ–‡æœ¬ â”‚ ï¿½åˆ†å±        â”‚ ğŸ¨ ä¸»é¢˜   â”‚
â”‚ åç§°: æŠ€æœ¯ç ”ç©¶  â”‚ â”œâ”€â• æ·»åŠ ç« èŠ‚     â”‚                           â”‚              â”‚ GitHub   â”‚
â”‚ åˆ†ç±»: ç ”ç©¶æ¨¡æ¿  â”‚ â”œâ”€ğŸ“ ç¼–è¾‘æ ‡é¢˜     â”‚                           â”‚              â”‚ å­¦æœ¯     â”‚
â”‚ æ ‡ç­¾: #æŠ€æœ¯     â”‚ â”œâ”€ğŸ”„ é‡æ–°æ’åº     â”‚                           â”‚              â”‚ å•†åŠ¡     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”œâ”€ğŸ“Š ç« èŠ‚ç»Ÿè®¡     â”‚                           â”‚              â”‚          â”‚
â”‚ â”‚ ğŸ”§ å˜é‡ç®¡ç† â”‚ â”‚ â””â”€âš™ï¸ å¤§çº²è®¾ç½®     â”‚                           â”‚              â”‚          â”‚
â”‚ â”‚ {topic}     â”‚ â”‚                  â”‚                           â”‚              â”‚          â”‚
â”‚ â”‚ {date}      â”‚ â”‚ ğŸ“ å½“å‰ä½ç½®:      â”‚                           â”‚              â”‚          â”‚
â”‚ â”‚ {author}    â”‚ â”‚ çŸ¥è¯†æ¡†æ¶ > æ ¸å¿ƒæ¦‚å¿µâ”‚                           â”‚              â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚                           â”‚              â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.2 ç¼–è¾‘æ¨¡å¼æ”¯æŒ
- **æºç æ¨¡å¼**: ç›´æ¥ç¼–è¾‘Markdown/HTMLæºç 
- **å¯Œæ–‡æœ¬æ¨¡å¼**: æ‰€è§å³æ‰€å¾—ç¼–è¾‘ä½“éªŒ
- **åˆ†å±æ¨¡å¼**: å·¦ä¾§æºç ï¼Œå³ä¾§é¢„è§ˆ
- **å…¨å±æ¨¡å¼**: ä¸“æ³¨ç¼–è¾‘ä½“éªŒ

### 2.2 æ¨¡æ¿ç»„ç»‡ç»“æ„

#### 2.2.1 ç›®å½•æ ‘ç»“æ„
```
æ¨¡æ¿åº“/
â”œâ”€â”€ ç³»ç»Ÿé»˜è®¤æ¨¡æ¿/
â”‚   â”œâ”€â”€ å·¥ä½œæ¨¡æ¿/
â”‚   â”‚   â”œâ”€â”€ æ—¥æŠ¥æ¨¡æ¿.md
â”‚   â”‚   â”œâ”€â”€ å‘¨æŠ¥æ¨¡æ¿.md
â”‚   â”‚   â”œâ”€â”€ æœˆæŠ¥æ¨¡æ¿.md
â”‚   â”‚   â””â”€â”€ ä¼šè®®è®°å½•æ¨¡æ¿.md
â”‚   â”œâ”€â”€ ç ”ç©¶æ¨¡æ¿/
â”‚   â”‚   â”œâ”€â”€ æŠ€æœ¯ç ”ç©¶ç¬”è®°.md
â”‚   â”‚   â”œâ”€â”€ å¸‚åœºåˆ†ææŠ¥å‘Š.md
â”‚   â”‚   â”œâ”€â”€ ç«å“åˆ†æ.md
â”‚   â”‚   â””â”€â”€ å­¦ä¹ ç¬”è®°.md
â”‚   â”œâ”€â”€ é¡¹ç›®æ¨¡æ¿/
â”‚   â”‚   â”œâ”€â”€ é¡¹ç›®å¯åŠ¨æ–‡æ¡£.md
â”‚   â”‚   â”œâ”€â”€ é¡¹ç›®å¤ç›˜æŠ¥å‘Š.md
â”‚   â”‚   â”œâ”€â”€ éœ€æ±‚åˆ†ææ–‡æ¡£.md
â”‚   â”‚   â””â”€â”€ æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡.md
â”‚   â””â”€â”€ é€šç”¨æ¨¡æ¿/
â”‚       â”œâ”€â”€ æ–‡ç« æ¨¡æ¿.md
â”‚       â”œâ”€â”€ æ¼”è®²ç¨¿æ¨¡æ¿.md
â”‚       â”œâ”€â”€ æ€»ç»“æ¨¡æ¿.md
â”‚       â””â”€â”€ è®¡åˆ’æ¨¡æ¿.md
â”œâ”€â”€ ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿/
â”‚   â”œâ”€â”€ æˆ‘çš„æ—¥å¸¸/
â”‚   â”œâ”€â”€ æˆ‘çš„å·¥ä½œ/
â”‚   â”œâ”€â”€ æˆ‘çš„ç ”ç©¶/
â”‚   â””â”€â”€ æˆ‘çš„é¡¹ç›®/
â”œâ”€â”€ å…±äº«æ¨¡æ¿/
â”‚   â”œâ”€â”€ å›¢é˜Ÿæ¨¡æ¿/
â”‚   â”œâ”€â”€ éƒ¨é—¨æ¨¡æ¿/
â”‚   â””â”€â”€ å…¬å¸æ¨¡æ¿/
â”œâ”€â”€ æ¨¡æ¿é…ç½®/
â”‚   â”œâ”€â”€ template_config.json
â”‚   â”œâ”€â”€ variables.json
â”‚   â””â”€â”€ themes.json
â””â”€â”€ ç‰ˆæœ¬å†å²/
    â”œâ”€â”€ æ¨¡æ¿åç§°/
    â”‚   â”œâ”€â”€ v1.0.0.md
    â”‚   â”œâ”€â”€ v1.1.0.md
    â”‚   â””â”€â”€ v2.0.0.md
    â””â”€â”€ ...
```

#### 2.2.2 æ¨¡æ¿å…ƒæ•°æ®ç»“æ„
```json
{
  "id": "template_daily_report_v1",
  "name": "æ—¥æŠ¥æ¨¡æ¿",
  "description": "ç”¨äºè®°å½•æ¯æ—¥å·¥ä½œè¿›å±•å’Œæ€è€ƒçš„æ¨¡æ¿",
  "category": "å·¥ä½œæ¨¡æ¿",
  "subcategory": "æ—¥å¸¸è®°å½•",
  "tags": ["æ—¥æŠ¥", "å·¥ä½œ", "è®°å½•"],
  "author": "system",
  "version": "1.0.0",
  "created_at": "2025-07-04T10:00:00Z",
  "updated_at": "2025-07-04T10:00:00Z",
  "usage_count": 156,
  "rating": 4.8,
  "file_path": "ç³»ç»Ÿé»˜è®¤æ¨¡æ¿/å·¥ä½œæ¨¡æ¿/æ—¥æŠ¥æ¨¡æ¿.md",
  "preview_image": "previews/daily_report_preview.png",
  "variables": [
    {
      "name": "date",
      "type": "date",
      "default": "today",
      "description": "æŠ¥å‘Šæ—¥æœŸ"
    },
    {
      "name": "author",
      "type": "string",
      "default": "current_user",
      "description": "æŠ¥å‘Šä½œè€…"
    },
    {
      "name": "weather",
      "type": "string",
      "default": "æ™´æœ—",
      "description": "å¤©æ°”çŠ¶å†µ"
    },
    {
      "name": "mood",
      "type": "select",
      "options": ["ğŸ˜Š", "ğŸ˜", "ğŸ˜”", "ğŸ˜¤", "ğŸ¤”"],
      "default": "ğŸ˜Š",
      "description": "å¿ƒæƒ…çŠ¶æ€"
    }
  ],
  "ai_features": {
    "auto_summary": true,
    "smart_tags": true,
    "content_suggestions": true
  },
  "output_formats": ["markdown", "html", "pdf", "word"],
  "permissions": {
    "read": ["all"],
    "write": ["owner", "admin"],
    "share": ["owner", "admin"]
  }
}
```

### 2.3 æ¨¡æ¿å˜é‡ç³»ç»Ÿ

#### 2.3.1 å˜é‡ç±»å‹å®šä¹‰
```python
class TemplateVariable:
    """æ¨¡æ¿å˜é‡åŸºç±»"""
    
    def __init__(self, name, var_type, default=None, description=""):
        self.name = name
        self.type = var_type
        self.default = default
        self.description = description
    
    def render(self, context):
        raise NotImplementedError

class DateVariable(TemplateVariable):
    """æ—¥æœŸå˜é‡"""
    FORMATS = {
        'date': '%Y-%m-%d',
        'datetime': '%Y-%m-%d %H:%M:%S',
        'time': '%H:%M:%S',
        'chinese_date': '%Yå¹´%mæœˆ%dæ—¥',
        'week': 'ç¬¬%Wå‘¨',
        'month': '%Yå¹´%mæœˆ'
    }
    
    def render(self, context):
        from datetime import datetime
        if self.default == 'today':
            return datetime.now().strftime(self.FORMATS.get('date'))
        elif self.default == 'now':
            return datetime.now().strftime(self.FORMATS.get('datetime'))
        return self.default

class StringVariable(TemplateVariable):
    """æ–‡æœ¬å˜é‡"""
    
    def render(self, context):
        if self.default == 'current_user':
            return context.get('user_name', 'æœªçŸ¥ç”¨æˆ·')
        return context.get(self.name, self.default)

class SelectVariable(TemplateVariable):
    """é€‰æ‹©å˜é‡"""
    
    def __init__(self, name, options, default=None, description=""):
        super().__init__(name, 'select', default, description)
        self.options = options
    
    def render(self, context):
        return context.get(self.name, self.default)

class PlaceholderVariable(TemplateVariable):
    """å ä½ç¬¦å˜é‡"""
    
    def render(self, context):
        placeholder_text = context.get(self.name, "")
        if not placeholder_text:
            return f"<!-- {self.description} -->"
        return placeholder_text
```

#### 2.3.2 å˜é‡å¤„ç†å¼•æ“
```python
class TemplateEngine:
    """æ¨¡æ¿æ¸²æŸ“å¼•æ“"""
    
    def __init__(self):
        self.variables = {}
        self.functions = {}
    
    def register_variable(self, variable: TemplateVariable):
        """æ³¨å†Œæ¨¡æ¿å˜é‡"""
        self.variables[variable.name] = variable
    
    def register_function(self, name: str, func: callable):
        """æ³¨å†Œæ¨¡æ¿å‡½æ•°"""
        self.functions[name] = func
    
    def render(self, template_content: str, context: dict) -> str:
        """æ¸²æŸ“æ¨¡æ¿"""
        import re
        
        # å¤„ç†å˜é‡æ›¿æ¢
        def replace_variable(match):
            var_name = match.group(1)
            if var_name in self.variables:
                return str(self.variables[var_name].render(context))
            return match.group(0)
        
        # æ›¿æ¢ {variable} æ ¼å¼çš„å˜é‡
        result = re.sub(r'\{(\w+)\}', replace_variable, template_content)
        
        # å¤„ç†å‡½æ•°è°ƒç”¨
        def replace_function(match):
            func_name = match.group(1)
            args = match.group(2).split(',') if match.group(2) else []
            if func_name in self.functions:
                return str(self.functions[func_name](*args))
            return match.group(0)
        
        # æ›¿æ¢ {{function(args)}} æ ¼å¼çš„å‡½æ•°è°ƒç”¨
        result = re.sub(r'\{\{(\w+)\(([^)]*)\)\}\}', replace_function, result)
        
        return result
```

### 2.4 æ¨¡æ¿ç¼–è¾‘å™¨åŠŸèƒ½

#### 2.4.1 å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
- **åŸºäºMonaco Editor**: æä¾›VS Codeçº§åˆ«çš„ç¼–è¾‘ä½“éªŒ
- **è¯­æ³•é«˜äº®**: æ”¯æŒMarkdownã€HTMLã€JSONç­‰å¤šç§æ ¼å¼
- **æ™ºèƒ½æç¤º**: å˜é‡åã€å‡½æ•°åè‡ªåŠ¨è¡¥å…¨
- **é”™è¯¯æ£€æŸ¥**: è¯­æ³•é”™è¯¯å®æ—¶æç¤º
- **ä»£ç æŠ˜å **: æ”¯æŒå¤§çº²è§†å›¾å’Œä»£ç å—æŠ˜å 

#### 2.4.2 å¯è§†åŒ–ç¼–è¾‘å™¨
```python
class VisualTemplateEditor:
    """å¯è§†åŒ–æ¨¡æ¿ç¼–è¾‘å™¨"""
    
    def __init__(self):
        self.components = []
        self.layout = None
    
    def add_component(self, component_type, config):
        """æ·»åŠ ç»„ä»¶"""
        component = {
            'id': self.generate_id(),
            'type': component_type,
            'config': config,
            'position': {'x': 0, 'y': 0, 'width': 100, 'height': 50}
        }
        self.components.append(component)
    
    def available_components(self):
        """å¯ç”¨ç»„ä»¶åˆ—è¡¨"""
        return {
            'text': {
                'name': 'æ–‡æœ¬å—',
                'icon': 'ğŸ“',
                'config': {
                    'content': 'è¾“å…¥æ–‡æœ¬å†…å®¹',
                    'style': 'normal',
                    'align': 'left'
                }
            },
            'heading': {
                'name': 'æ ‡é¢˜',
                'icon': 'ğŸ”¤',
                'config': {
                    'level': 1,
                    'content': 'æ ‡é¢˜å†…å®¹',
                    'style': 'default'
                }
            },
            'list': {
                'name': 'åˆ—è¡¨',
                'icon': 'ğŸ“‹',
                'config': {
                    'type': 'unordered',
                    'items': ['é¡¹ç›®1', 'é¡¹ç›®2', 'é¡¹ç›®3']
                }
            },
            'table': {
                'name': 'è¡¨æ ¼',
                'icon': 'ğŸ“Š',
                'config': {
                    'rows': 3,
                    'columns': 3,
                    'headers': True
                }
            },
            'image': {
                'name': 'å›¾ç‰‡',
                'icon': 'ğŸ–¼ï¸',
                'config': {
                    'src': 'placeholder.jpg',
                    'alt': 'å›¾ç‰‡æè¿°',
                    'width': 300
                }
            },
            'variable': {
                'name': 'å˜é‡',
                'icon': 'ğŸ”§',
                'config': {
                    'name': 'variable_name',
                    'type': 'string',
                    'default': 'é»˜è®¤å€¼'
                }
            },
            'placeholder': {
                'name': 'å ä½ç¬¦',
                'icon': 'ğŸ“',
                'config': {
                    'name': 'content_area',
                    'description': 'å†…å®¹åŒºåŸŸ',
                    'min_height': 100
                }
            },
            'separator': {
                'name': 'åˆ†å‰²çº¿',
                'icon': 'â–',
                'config': {
                    'style': 'solid',
                    'thickness': 1
                }
            }
        }
```

#### 2.4.3 æ¨¡æ¿é¢„è§ˆç³»ç»Ÿ
```python
class TemplatePreviewEngine:
    """æ¨¡æ¿é¢„è§ˆå¼•æ“"""
    
    def __init__(self):
        self.themes = self.load_themes()
        self.renderers = {
            'markdown': self.render_markdown,
            'html': self.render_html,
            'word': self.render_word,
            'pdf': self.render_pdf
        }
    
    def preview(self, template_content, output_format='html', theme='default'):
        """ç”Ÿæˆé¢„è§ˆ"""
        if output_format in self.renderers:
            return self.renderers[output_format](template_content, theme)
        raise ValueError(f"ä¸æ”¯æŒçš„è¾“å‡ºæ ¼å¼: {output_format}")
    
    def render_markdown(self, content, theme):
        """æ¸²æŸ“Markdowné¢„è§ˆ"""
        import markdown
        from markdown.extensions import codehilite, tables, toc
        
        md = markdown.Markdown(extensions=[
            'codehilite',
            'tables',
            'toc',
            'fenced_code',
            'attr_list'
        ])
        
        html_content = md.convert(content)
        return self.apply_theme(html_content, theme)
    
    def render_html(self, content, theme):
        """æ¸²æŸ“HTMLé¢„è§ˆ"""
        return self.apply_theme(content, theme)
    
    def apply_theme(self, content, theme_name):
        """åº”ç”¨ä¸»é¢˜æ ·å¼"""
        theme = self.themes.get(theme_name, self.themes['default'])
        
        html_template = f"""
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>æ¨¡æ¿é¢„è§ˆ</title>
            <style>
                {theme['css']}
            </style>
        </head>
        <body>
            <div class="container">
                {content}
            </div>
        </body>
        </html>
        """
        return html_template
    
    def load_themes(self):
        """åŠ è½½ä¸»é¢˜é…ç½®"""
        return {
            'default': {
                'name': 'é»˜è®¤ä¸»é¢˜',
                'css': '''
                    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
                    .container { max-width: 800px; margin: 0 auto; padding: 20px; }
                    h1, h2, h3 { color: #333; }
                    pre { background: #f5f5f5; padding: 10px; border-radius: 4px; }
                    table { border-collapse: collapse; width: 100%; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                '''
            },
            'github': {
                'name': 'GitHubä¸»é¢˜',
                'css': '''
                    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; }
                    .container { max-width: 980px; margin: 0 auto; padding: 45px; }
                    h1, h2, h3 { border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
                    pre { background: #f6f8fa; padding: 16px; border-radius: 6px; }
                    code { background: #f6f8fa; padding: 2px 4px; border-radius: 3px; }
                '''
            },
            'academic': {
                'name': 'å­¦æœ¯ä¸»é¢˜',
                'css': '''
                    body { font-family: 'Times New Roman', Times, serif; line-height: 1.6; }
                    .container { max-width: 700px; margin: 0 auto; padding: 20px; }
                    h1, h2, h3 { font-weight: bold; margin-top: 1.5em; }
                    p { text-align: justify; margin-bottom: 1em; }
                    blockquote { border-left: 4px solid #ddd; margin-left: 0; padding-left: 1em; }
                '''
            }
        }
```

### 2.5 æ¨¡æ¿ç®¡ç†åŠŸèƒ½

#### 2.5.1 æ¨¡æ¿åˆ†ç±»ç®¡ç†
```python
class TemplateCategory:
    """æ¨¡æ¿åˆ†ç±»ç®¡ç†"""
    
    def __init__(self):
        self.categories = self.load_categories()
    
    def load_categories(self):
        """åŠ è½½åˆ†ç±»é…ç½®"""
        return {
            'work': {
                'name': 'å·¥ä½œæ¨¡æ¿',
                'icon': 'ğŸ’¼',
                'color': '#2196F3',
                'subcategories': {
                    'reports': {'name': 'æŠ¥å‘Šæ¨¡æ¿', 'icon': 'ğŸ“Š'},
                    'meetings': {'name': 'ä¼šè®®æ¨¡æ¿', 'icon': 'ğŸ‘¥'},
                    'planning': {'name': 'è®¡åˆ’æ¨¡æ¿', 'icon': 'ğŸ“…'}
                }
            },
            'research': {
                'name': 'ç ”ç©¶æ¨¡æ¿',
                'icon': 'ğŸ”¬',
                'color': '#4CAF50',
                'subcategories': {
                    'analysis': {'name': 'åˆ†ææ¨¡æ¿', 'icon': 'ğŸ“ˆ'},
                    'notes': {'name': 'ç¬”è®°æ¨¡æ¿', 'icon': 'ğŸ“'},
                    'papers': {'name': 'è®ºæ–‡æ¨¡æ¿', 'icon': 'ğŸ“„'}
                }
            },
            'project': {
                'name': 'é¡¹ç›®æ¨¡æ¿',
                'icon': 'ğŸš€',
                'color': '#FF9800',
                'subcategories': {
                    'startup': {'name': 'å¯åŠ¨æ¨¡æ¿', 'icon': 'ğŸ¯'},
                    'management': {'name': 'ç®¡ç†æ¨¡æ¿', 'icon': 'ğŸ“‹'},
                    'review': {'name': 'è¯„å®¡æ¨¡æ¿', 'icon': 'ğŸ”'}
                }
            },
            'personal': {
                'name': 'ä¸ªäººæ¨¡æ¿',
                'icon': 'ğŸ‘¤',
                'color': '#9C27B0',
                'subcategories': {
                    'diary': {'name': 'æ—¥è®°æ¨¡æ¿', 'icon': 'ğŸ“–'},
                    'learning': {'name': 'å­¦ä¹ æ¨¡æ¿', 'icon': 'ğŸ“'},
                    'life': {'name': 'ç”Ÿæ´»æ¨¡æ¿', 'icon': 'ğŸ '}
                }
            }
        }
```

#### 2.5.2 æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶
```python
class TemplateVersionControl:
    """æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶"""
    
    def __init__(self):
        self.versions = {}
    
    def create_version(self, template_id, content, comment=""):
        """åˆ›å»ºæ–°ç‰ˆæœ¬"""
        import time
        import hashlib
        
        version_id = hashlib.md5(content.encode()).hexdigest()[:8]
        version = {
            'id': version_id,
            'template_id': template_id,
            'content': content,
            'created_at': time.time(),
            'comment': comment,
            'size': len(content)
        }
        
        if template_id not in self.versions:
            self.versions[template_id] = []
        
        self.versions[template_id].append(version)
        return version_id
    
    def get_versions(self, template_id):
        """è·å–ç‰ˆæœ¬åˆ—è¡¨"""
        return self.versions.get(template_id, [])
    
    def get_version(self, template_id, version_id):
        """è·å–ç‰¹å®šç‰ˆæœ¬"""
        versions = self.versions.get(template_id, [])
        for version in versions:
            if version['id'] == version_id:
                return version
        return None
    
    def compare_versions(self, template_id, version1_id, version2_id):
        """æ¯”è¾ƒç‰ˆæœ¬å·®å¼‚"""
        import difflib
        
        version1 = self.get_version(template_id, version1_id)
        version2 = self.get_version(template_id, version2_id)
        
        if not version1 or not version2:
            return None
        
        diff = difflib.unified_diff(
            version1['content'].splitlines(),
            version2['content'].splitlines(),
            fromfile=f"ç‰ˆæœ¬ {version1_id}",
            tofile=f"ç‰ˆæœ¬ {version2_id}",
            lineterm=""
        )
        
        return '\n'.join(diff)
```

### 2.6 æ¨¡æ¿åº”ç”¨ç³»ç»Ÿ

#### 2.6.1 æ¨¡æ¿å®ä¾‹åŒ–
```python
class TemplateInstantiator:
    """æ¨¡æ¿å®ä¾‹åŒ–å™¨"""
    
    def __init__(self):
        self.engine = TemplateEngine()
    
    def create_document(self, template_id, variables=None, output_path=None):
        """åŸºäºæ¨¡æ¿åˆ›å»ºæ–‡æ¡£"""
        template = self.load_template(template_id)
        if not template:
            raise ValueError(f"æ¨¡æ¿ä¸å­˜åœ¨: {template_id}")
        
        # å‡†å¤‡å˜é‡ä¸Šä¸‹æ–‡
        context = self.prepare_context(variables or {})
        
        # æ¸²æŸ“æ¨¡æ¿
        content = self.engine.render(template['content'], context)
        
        # ç”Ÿæˆæ–‡æ¡£
        document = {
            'id': self.generate_document_id(),
            'title': self.extract_title(content),
            'content': content,
            'template_id': template_id,
            'created_at': self.current_time(),
            'variables': context,
            'metadata': {
                'template_name': template['name'],
                'template_version': template['version'],
                'output_format': template.get('output_format', 'markdown')
            }
        }
        
        # ä¿å­˜æ–‡æ¡£
        if output_path:
            self.save_document(document, output_path)
        
        return document
    
    def prepare_context(self, variables):
        """å‡†å¤‡æ¨¡æ¿ä¸Šä¸‹æ–‡"""
        import os
        from datetime import datetime
        
        context = {
            'current_user': os.getenv('USERNAME', 'æœªçŸ¥ç”¨æˆ·'),
            'current_date': datetime.now().strftime('%Y-%m-%d'),
            'current_time': datetime.now().strftime('%H:%M:%S'),
            'current_datetime': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
            'year': datetime.now().year,
            'month': datetime.now().month,
            'day': datetime.now().day,
            'weekday': datetime.now().strftime('%A'),
            'system_info': {
                'os': os.name,
                'platform': os.environ.get('OS', 'Unknown')
            }
        }
        
        # åˆå¹¶ç”¨æˆ·æä¾›çš„å˜é‡
        context.update(variables)
        return context
```

#### 2.6.2 æ™ºèƒ½æ¨¡æ¿æ¨è
```python
class TemplateRecommendationEngine:
    """æ¨¡æ¿æ¨èå¼•æ“"""
    
    def __init__(self):
        self.usage_stats = {}
        self.similarity_matrix = {}
    
    def recommend_templates(self, context, limit=5):
        """æ¨èæ¨¡æ¿"""
        recommendations = []
        
        # åŸºäºä½¿ç”¨é¢‘ç‡æ¨è
        frequency_scores = self.calculate_frequency_scores(context)
        
        # åŸºäºç›¸ä¼¼åº¦æ¨è
        similarity_scores = self.calculate_similarity_scores(context)
        
        # åŸºäºæ—¶é—´æ¨è
        time_scores = self.calculate_time_scores(context)
        
        # ç»¼åˆè¯„åˆ†
        all_templates = self.get_all_templates()
        for template in all_templates:
            score = (
                frequency_scores.get(template['id'], 0) * 0.4 +
                similarity_scores.get(template['id'], 0) * 0.4 +
                time_scores.get(template['id'], 0) * 0.2
            )
            recommendations.append({
                'template': template,
                'score': score,
                'reasons': self.get_recommendation_reasons(template, context)
            })
        
        # æ’åºå¹¶è¿”å›å‰Nä¸ª
        recommendations.sort(key=lambda x: x['score'], reverse=True)
        return recommendations[:limit]
    
    def get_recommendation_reasons(self, template, context):
        """è·å–æ¨èç†ç”±"""
        reasons = []
        
        # æ£€æŸ¥ä½¿ç”¨é¢‘ç‡
        if template['id'] in self.usage_stats:
            usage = self.usage_stats[template['id']]
            if usage['frequency'] > 5:
                reasons.append(f"æ‚¨ç»å¸¸ä½¿ç”¨æ­¤æ¨¡æ¿ï¼ˆ{usage['frequency']}æ¬¡ï¼‰")
        
        # æ£€æŸ¥æ—¶é—´ç›¸å…³æ€§
        current_hour = context.get('current_hour', 0)
        if 9 <= current_hour <= 11 and 'morning' in template.get('tags', []):
            reasons.append("é€‚åˆä¸Šåˆä½¿ç”¨")
        elif 14 <= current_hour <= 17 and 'afternoon' in template.get('tags', []):
            reasons.append("é€‚åˆä¸‹åˆä½¿ç”¨")
        
        # æ£€æŸ¥ç±»å‹åŒ¹é…
        if context.get('document_type') == template.get('category'):
            reasons.append("ç±»å‹åŒ¹é…")
        
        return reasons
```

### 2.7 é«˜çº§åŠŸèƒ½

#### 2.7.1 æ¨¡æ¿åä½œç³»ç»Ÿ
```python
class TemplateCollaborationSystem:
    """æ¨¡æ¿åä½œç³»ç»Ÿ"""
    
    def __init__(self):
        self.shared_templates = {}
        self.permissions = {}
        self.comments = {}
    
    def share_template(self, template_id, user_id, permissions=['read']):
        """åˆ†äº«æ¨¡æ¿"""
        if template_id not in self.shared_templates:
            self.shared_templates[template_id] = {
                'owner': user_id,
                'shared_with': [],
                'public': False,
                'created_at': self.current_time()
            }
        
        self.permissions[template_id] = permissions
        return self.generate_share_link(template_id)
    
    def add_comment(self, template_id, user_id, comment, line_number=None):
        """æ·»åŠ è¯„è®º"""
        if template_id not in self.comments:
            self.comments[template_id] = []
        
        comment_obj = {
            'id': self.generate_comment_id(),
            'user_id': user_id,
            'content': comment,
            'line_number': line_number,
            'created_at': self.current_time(),
            'replies': []
        }
        
        self.comments[template_id].append(comment_obj)
        return comment_obj['id']
    
    def suggest_edit(self, template_id, user_id, suggestion):
        """å»ºè®®ç¼–è¾‘"""
        suggestion_obj = {
            'id': self.generate_suggestion_id(),
            'template_id': template_id,
            'user_id': user_id,
            'suggestion': suggestion,
            'status': 'pending',
            'created_at': self.current_time()
        }
        
        # é€šçŸ¥æ¨¡æ¿æ‰€æœ‰è€…
        self.notify_owner(template_id, suggestion_obj)
        return suggestion_obj
```

#### 2.7.2 æ¨¡æ¿AIå¢å¼º
```python
class TemplateAIEnhancer:
    """æ¨¡æ¿AIå¢å¼ºå™¨"""
    
    def __init__(self, ai_service):
        self.ai_service = ai_service
    
    def enhance_template(self, template_content, enhancement_type='auto'):
        """å¢å¼ºæ¨¡æ¿"""
        enhancements = {
            'auto': self.auto_enhance,
            'structure': self.improve_structure,
            'language': self.improve_language,
            'variables': self.suggest_variables,
            'content': self.suggest_content
        }
        
        if enhancement_type in enhancements:
            return enhancements[enhancement_type](template_content)
        else:
            return self.auto_enhance(template_content)
    
    def auto_enhance(self, content):
        """è‡ªåŠ¨å¢å¼º"""
        prompt = f"""
        è¯·åˆ†æä»¥ä¸‹æ¨¡æ¿å†…å®¹ï¼Œå¹¶æä¾›æ”¹è¿›å»ºè®®ï¼š
        
        {content}
        
        è¯·ä»ä»¥ä¸‹æ–¹é¢æä¾›å»ºè®®ï¼š
        1. ç»“æ„ä¼˜åŒ–
        2. å†…å®¹å®Œå–„
        3. å˜é‡å»ºè®®
        4. æ ¼å¼æ”¹è¿›
        
        è¿”å›JSONæ ¼å¼çš„å»ºè®®ã€‚
        """
        
        response = self.ai_service.generate_response(prompt)
        return self.parse_ai_suggestions(response)
    
    def suggest_variables(self, content):
        """å»ºè®®å˜é‡"""
        prompt = f"""
        åˆ†æä»¥ä¸‹æ¨¡æ¿å†…å®¹ï¼Œè¯†åˆ«å¯ä»¥å‚æ•°åŒ–çš„éƒ¨åˆ†ï¼Œå»ºè®®åˆé€‚çš„å˜é‡ï¼š
        
        {content}
        
        è¿”å›å˜é‡å»ºè®®åˆ—è¡¨ï¼ŒåŒ…æ‹¬å˜é‡åã€ç±»å‹ã€é»˜è®¤å€¼å’Œæè¿°ã€‚
        """
        
        response = self.ai_service.generate_response(prompt)
        return self.parse_variable_suggestions(response)
    
    def generate_template_from_description(self, description):
        """æ ¹æ®æè¿°ç”Ÿæˆæ¨¡æ¿"""
        prompt = f"""
        æ ¹æ®ä»¥ä¸‹æè¿°ç”Ÿæˆä¸€ä¸ªMarkdownæ¨¡æ¿ï¼š
        
        {description}
        
        è¦æ±‚ï¼š
        1. åŒ…å«åˆé€‚çš„æ ‡é¢˜ç»“æ„
        2. æ·»åŠ å¿…è¦çš„å˜é‡å ä½ç¬¦
        3. æä¾›æ¸…æ™°çš„å†…å®¹åŒºåŸŸ
        4. ä½¿ç”¨åˆé€‚çš„Markdownæ ¼å¼
        
        è¿”å›å®Œæ•´çš„æ¨¡æ¿å†…å®¹ã€‚
        """
        
        response = self.ai_service.generate_response(prompt)
        return response
```

### 2.8 Wordæ–‡æ¡£æ”¯æŒæ‰©å±• âœ… å·²å®ç°

#### 2.8.1 Wordæ–‡æ¡£å¤„ç†æ¶æ„ï¼ˆå·²å®Œæˆå®ç°ï¼‰

**å®ç°çŠ¶æ€ï¼šâœ… å®Œæˆ**
- âœ… Wordæ–‡æ¡£è§£æå™¨ (`src/core/word_parser.py`)
- âœ… æ–‡æ¡£ç¼–è¾‘å™¨Wordé›†æˆ (`src/gui/document_editor.py`)  
- âœ… å¤§çº²å¯¼èˆªå™¨Wordæ”¯æŒ (`src/gui/document_outline_navigator.py`)
- âœ… GUIé›†æˆå’Œæµ‹è¯•éªŒè¯

```python
# å®é™…å®ç°çš„Wordæ–‡æ¡£å¤„ç†æ¶æ„
class WordDocumentParser:
    """Wordæ–‡æ¡£è§£æå™¨ - å·²å®Œæˆå®ç°"""
    
    def __init__(self):
        self.logger = logging.getLogger(__name__)
        self._check_dependencies()
    
    def is_word_file(self, file_path: str) -> bool:
        """æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºWordæ–‡æ¡£"""
        suffix = Path(file_path).suffix.lower()
        return suffix in ['.docx', '.doc']
    
    def extract_text_content(self, file_path: str) -> WordParseResult:
        """æå–Wordæ–‡æ¡£çš„çº¯æ–‡æœ¬å†…å®¹"""
        # å·²å®ç°ï¼šä½¿ç”¨docx2txtå¿«é€Ÿæå–
        
    def extract_structured_content(self, file_path: str) -> WordParseResult:
        """æå–Wordæ–‡æ¡£çš„ç»“æ„åŒ–å†…å®¹ï¼Œè½¬æ¢ä¸ºMarkdownæ ¼å¼"""
        # å·²å®ç°ï¼šè§£ææ®µè½ã€æ ‡é¢˜ã€è¡¨æ ¼ç­‰ç»“æ„
        
    def get_outline_items(self, file_path: str) -> List[OutlineItem]:
        """ä»Wordæ–‡æ¡£æå–å¤§çº²ç»“æ„"""
        # å·²å®ç°ï¼šä¸“é—¨ç”¨äºå¤§çº²å¯¼èˆªåŠŸèƒ½
        
    def convert_to_markdown(self, file_path: str) -> str:
        """å°†Wordæ–‡æ¡£è½¬æ¢ä¸ºMarkdownæ ¼å¼"""
        # å·²å®ç°ï¼šWord â†’ Markdownè½¬æ¢
        
    def save_as_word(self, content: str, output_path: str, title: Optional[str] = None) -> bool:
        """å°†Markdownå†…å®¹ä¿å­˜ä¸ºWordæ–‡æ¡£"""
        # å·²å®ç°ï¼šMarkdown â†’ Wordè½¬æ¢

# ä¾¿æ·å‡½æ•°ï¼ˆå·²å®ç°ï¼‰
def quick_word_to_markdown(file_path: str) -> str:
    """å¿«é€Ÿå°†Wordæ–‡æ¡£è½¬æ¢ä¸ºMarkdown"""
    
def quick_markdown_to_word(content: str, output_path: str, title: Optional[str] = None) -> bool:
    """å¿«é€Ÿå°†Markdownä¿å­˜ä¸ºWordæ–‡æ¡£"""
```

#### 2.8.2 GUIé›†æˆå®ç°ï¼ˆå·²å®Œæˆï¼‰

**æ–‡æ¡£ç¼–è¾‘å™¨é›†æˆï¼ˆDocumentEditorï¼‰ï¼š**
- âœ… Wordæ–‡æ¡£ç±»å‹è¯†åˆ«å’Œæ–‡ä»¶å¯¹è¯æ¡†æ”¯æŒ
- âœ… Wordæ–‡æ¡£è‡ªåŠ¨è½¬æ¢ä¸ºMarkdownç¼–è¾‘æ¨¡å¼
- âœ… Wordæ–‡æ¡£çŠ¶æ€æŒ‡ç¤ºå’Œæ ‡è¯†æ˜¾ç¤º
- âœ… å·¥å…·æ WordåŠŸèƒ½ï¼ˆæ¨¡å¼åˆ‡æ¢ã€ä¿å­˜ä¸ºWordï¼‰
- âœ… Wordè§£æå™¨å®Œå…¨é›†æˆ

**å¤§çº²å¯¼èˆªå™¨é›†æˆï¼ˆDocumentOutlineNavigatorï¼‰ï¼š**
- âœ… Wordæ–‡æ¡£å¤§çº²ç»“æ„è§£æå’Œæ˜¾ç¤º
- âœ… Wordæ–‡æ¡£å¤§çº²è·³è½¬åŠŸèƒ½
- âœ… ä¸Markdownå¤§çº²ç»Ÿä¸€çš„å¤„ç†æ–¹å¼
- âœ… å®æ—¶å¤§çº²æ›´æ–°å’ŒåŒæ­¥

#### 2.8.3 æµ‹è¯•éªŒè¯ï¼ˆå·²å®Œæˆï¼‰

**åŠŸèƒ½æµ‹è¯•ï¼š**
- âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼šæ–‡æ¡£ç±»å‹è¯†åˆ«ã€Markdownâ†”Wordè½¬æ¢ã€å¤§çº²æå–ã€å…ƒæ•°æ®æå–
- âœ… é«˜çº§åŠŸèƒ½æµ‹è¯•ï¼šé”™è¯¯å¤„ç†ã€ç©ºå†…å®¹ã€å¤§æ–‡æ¡£(25KB+)ã€ç‰¹æ®Šå­—ç¬¦å¤„ç†
- âœ… GUIé›†æˆæµ‹è¯•ï¼šç¼–è¾‘å™¨å’Œå¯¼èˆªå™¨çš„Wordæ”¯æŒéªŒè¯

**æµ‹è¯•ç»“æœï¼š**
- æ‰€æœ‰åŸºç¡€åŠŸèƒ½æµ‹è¯•é€šè¿‡ç‡ï¼š100%
- æ‰€æœ‰é«˜çº§åŠŸèƒ½æµ‹è¯•é€šè¿‡ç‡ï¼š100%
- GUIé›†æˆåŠŸèƒ½æ­£å¸¸ï¼Œæ”¯æŒWordæ–‡æ¡£çš„å®Œæ•´ç¼–è¾‘æµç¨‹
            'metadata': self.extract_metadata(doc),
            'outline': self.extract_outline(doc),
            'content': self.extract_content(doc),
            'styles': self.extract_styles(doc)
        }
    
    def extract_outline(self, doc) -> List[OutlineItem]:
        """æå–å¤§çº²ç»“æ„"""
        outline_items = []
        
        for i, paragraph in enumerate(doc.paragraphs):
            style_name = paragraph.style.name
            text = paragraph.text.strip()
            
            if style_name.startswith('Heading') and text:
                level = int(style_name.split()[-1])
                
                item = OutlineItem(
                    text=text,
                    level=level,
                    line_number=i + 1,
                    item_type="heading"
                )
                outline_items.append(item)
        
        return outline_items

class WordToMarkdownConverter:
    """Wordåˆ°Markdownè½¬æ¢å™¨"""
    
    def convert(self, word_content: Dict[str, Any]) -> str:
        """è½¬æ¢Wordå†…å®¹ä¸ºMarkdown"""
        content_parts = []
        
        # æ·»åŠ æ–‡æ¡£æ ‡é¢˜
        if word_content['metadata'].get('title'):
            content_parts.append(f"# {word_content['metadata']['title']}\n")
        
        # è½¬æ¢æ®µè½å†…å®¹
        for paragraph in word_content['content']['paragraphs']:
            markdown_text = self.convert_paragraph(paragraph)
            if markdown_text:
                content_parts.append(markdown_text)
        
        return '\n\n'.join(content_parts)
    
    def convert_paragraph(self, paragraph: Dict[str, Any]) -> str:
        """è½¬æ¢å•ä¸ªæ®µè½"""
        style = paragraph.get('style', '')
        text = paragraph.get('text', '')
        
        if style.startswith('Heading'):
            level = int(style.split()[-1])
            return '#' * level + ' ' + text
        elif style == 'List Paragraph':
            return '- ' + text
        else:
            return text

class MarkdownToWordExporter:
    """Markdownåˆ°Wordå¯¼å‡ºå™¨"""
    
    def export(self, markdown_content: str, output_path: str):
        """å¯¼å‡ºMarkdownä¸ºWordæ–‡æ¡£"""
        from docx import Document
        from docx.shared import Inches
        
        doc = Document()
        
        # è§£æMarkdownå¹¶è½¬æ¢ä¸ºWord
        lines = markdown_content.split('\n')
        
        for line in lines:
            if line.startswith('#'):
                # å¤„ç†æ ‡é¢˜
                level = len(line) - len(line.lstrip('#'))
                title_text = line.lstrip('# ').strip()
                
                heading = doc.add_heading(title_text, level=min(level, 9))
            elif line.strip():
                # å¤„ç†æ™®é€šæ®µè½
                doc.add_paragraph(line)
        
        doc.save(output_path)
```

#### 2.8.2 WordåŠŸèƒ½é›†æˆ
```python
class TemplateEditorWithWordSupport(TemplateEditor):
    """æ”¯æŒWordçš„æ¨¡æ¿ç¼–è¾‘å™¨"""
    
    def __init__(self):
        super().__init__()
        self.word_handler = WordDocumentHandler()
    
    def open_word_template(self, file_path: str):
        """æ‰“å¼€Wordæ¨¡æ¿"""
        try:
            if not self.word_handler.is_word_available():
                self.show_word_unavailable_message()
                return
            
            # è¯»å–Wordæ–‡æ¡£
            word_content = self.word_handler.read_word_document(file_path)
            
            # è½¬æ¢ä¸ºMarkdownè¿›è¡Œç¼–è¾‘
            markdown_content = self.word_handler.convert_to_markdown(word_content)
            
            # åœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤º
            self.set_content(markdown_content)
            self.set_file_path(file_path)
            self.set_edit_mode('word_to_markdown')
            
            # æ˜¾ç¤ºWordæ–‡æ¡£çŠ¶æ€
            self.show_word_edit_mode_info()
            
        except Exception as e:
            self.show_error_message(f"Wordæ–‡æ¡£å¤„ç†å¤±è´¥: {str(e)}")
    
    def save_as_word(self, output_path: str = None):
        """ä¿å­˜ä¸ºWordæ ¼å¼"""
        try:
            if not output_path:
                output_path = self.get_word_save_path()
            
            markdown_content = self.get_content()
            self.word_handler.save_as_word(markdown_content, output_path)
            
            self.show_success_message(f"å·²ä¿å­˜ä¸ºWordæ–‡æ¡£: {output_path}")
            
        except Exception as e:
            self.show_error_message(f"ä¿å­˜Wordæ–‡æ¡£å¤±è´¥: {str(e)}")
    
    def show_word_edit_mode_info(self):
        """æ˜¾ç¤ºWordç¼–è¾‘æ¨¡å¼è¯´æ˜"""
        info_text = """
        Wordæ–‡æ¡£ç¼–è¾‘æ¨¡å¼ï¼š
        â€¢ æ–‡æ¡£å·²è½¬æ¢ä¸ºMarkdownæ ¼å¼è¿›è¡Œç¼–è¾‘
        â€¢ ç¼–è¾‘å®Œæˆåå¯ä¿å­˜ä¸ºWordæ ¼å¼
        â€¢ éƒ¨åˆ†Wordç‰¹æœ‰æ ¼å¼å¯èƒ½ä¸¢å¤±
        â€¢ æ”¯æŒæ ‡é¢˜ã€æ®µè½ã€åˆ—è¡¨ç­‰åŸºç¡€æ ¼å¼
        """
        self.show_info_message(info_text)
```

#### 2.8.3 WordåŠŸèƒ½éš”ç¦»ç­–ç•¥
- **å¯é€‰ä¾èµ–**: WordåŠŸèƒ½ä½œä¸ºå¯é€‰ä¾èµ–ï¼Œç³»ç»Ÿå¯åœ¨æ²¡æœ‰Wordæ”¯æŒæ—¶æ­£å¸¸è¿è¡Œ
- **é”™è¯¯éš”ç¦»**: Wordå¤„ç†é”™è¯¯ä¸å½±å“å…¶ä»–æ¨¡æ¿åŠŸèƒ½
- **åŠŸèƒ½å¼€å…³**: æä¾›WordåŠŸèƒ½å¼€å…³ï¼Œå¯ä»¥éšæ—¶å¯ç”¨/ç¦ç”¨
- **é™çº§å¤„ç†**: WordåŠŸèƒ½ä¸å¯ç”¨æ—¶æä¾›æ›¿ä»£æ–¹æ¡ˆ

## 3. æŠ€æœ¯å®ç°

### 3.1 å‰ç«¯æŠ€æœ¯æ ˆ
- **PyQt6**: ä¸»è¦UIæ¡†æ¶
- **QWebEngine**: ç”¨äºé¢„è§ˆå’Œå¯Œæ–‡æœ¬ç¼–è¾‘
- **QSyntaxHighlighter**: è¯­æ³•é«˜äº®
- **QCompleter**: è‡ªåŠ¨è¡¥å…¨
- **QSplitter**: å¯è°ƒæ•´é¢æ¿å¸ƒå±€

### 3.2 åç«¯æŠ€æœ¯æ ˆ
- **FastAPI**: APIæœåŠ¡æ¡†æ¶
- **SQLAlchemy**: ORMæ¡†æ¶
- **Jinja2**: æ¨¡æ¿å¼•æ“
- **Markdown**: Markdownå¤„ç†
- **python-docx**: Wordæ–‡æ¡£å¤„ç†ï¼ˆç‹¬ç«‹word_parseræ¨¡å—ï¼Œè´Ÿè´£Wordè¯»å–ã€è§£æã€è½¬æ¢ã€å¯¼å‡ºï¼Œä¸»ä¸šåŠ¡ä¸WordåŠŸèƒ½è§£è€¦ï¼‰
- **docx2txt**: Wordçº¯æ–‡æœ¬æå–è¾…åŠ©
- **ReportLab**: PDFç”Ÿæˆ

### 3.3 æ•°æ®å­˜å‚¨
- **SQLite**: æ¨¡æ¿å…ƒæ•°æ®å­˜å‚¨
- **æ–‡ä»¶ç³»ç»Ÿ**: æ¨¡æ¿å†…å®¹å­˜å‚¨
- **JSON**: é…ç½®æ–‡ä»¶å­˜å‚¨

## 4. ç”¨æˆ·ç•Œé¢è®¾è®¡

### 4.1 ä¸»ç•Œé¢å¸ƒå±€
é‡‡ç”¨ç°ä»£IDEé£æ ¼çš„å¤šé¢æ¿å¸ƒå±€ï¼Œæ”¯æŒé¢æ¿æ‹–æ‹½å’Œè‡ªå®šä¹‰å¸ƒå±€ã€‚

### 4.2 äº¤äº’è®¾è®¡
- **æ‹–æ‹½æ“ä½œ**: æ”¯æŒç»„ä»¶æ‹–æ‹½åˆ°ç¼–è¾‘åŒº
- **å³é”®èœå•**: æä¾›å¿«æ·æ“ä½œèœå•
- **é”®ç›˜å¿«æ·é”®**: æ”¯æŒå¸¸ç”¨æ“ä½œå¿«æ·é”®
- **æœç´¢åŠŸèƒ½**: æ”¯æŒæ¨¡æ¿å†…å®¹æœç´¢

### 4.3 å“åº”å¼è®¾è®¡
- **è‡ªé€‚åº”å¸ƒå±€**: æ”¯æŒä¸åŒå±å¹•å°ºå¯¸
- **ä¸»é¢˜ç³»ç»Ÿ**: æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜
- **å­—ä½“è®¾ç½®**: æ”¯æŒå­—ä½“å¤§å°è°ƒæ•´

## 5. æ€§èƒ½ä¼˜åŒ–

### 5.1 åŠ è½½ä¼˜åŒ–
- **å»¶è¿ŸåŠ è½½**: æŒ‰éœ€åŠ è½½æ¨¡æ¿å†…å®¹
- **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å¸¸ç”¨æ¨¡æ¿
- **å¼‚æ­¥å¤„ç†**: åå°å¤„ç†è€—æ—¶æ“ä½œ

### 5.2 æ¸²æŸ“ä¼˜åŒ–
- **è™šæ‹Ÿæ»šåŠ¨**: å¤„ç†å¤§é‡æ¨¡æ¿åˆ—è¡¨
- **å¢é‡æ¸²æŸ“**: åªæ¸²æŸ“å˜åŒ–çš„éƒ¨åˆ†
- **é¢„è§ˆç¼“å­˜**: ç¼“å­˜é¢„è§ˆç»“æœ

## 6. å®‰å…¨è€ƒè™‘

### 6.1 æ¨¡æ¿å®‰å…¨
- **ä»£ç æ³¨å…¥é˜²æŠ¤**: é˜²æ­¢æ¶æ„ä»£ç æ³¨å…¥
- **æƒé™æ§åˆ¶**: ä¸¥æ ¼çš„æ¨¡æ¿è®¿é—®æ§åˆ¶
- **å†…å®¹è¿‡æ»¤**: è¿‡æ»¤å±é™©å†…å®¹

### 6.2 æ•°æ®å®‰å…¨
- **åŠ å¯†å­˜å‚¨**: æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- **è®¿é—®æ—¥å¿—**: è®°å½•æ¨¡æ¿è®¿é—®æ—¥å¿—
- **å¤‡ä»½æœºåˆ¶**: å®šæœŸå¤‡ä»½æ¨¡æ¿æ•°æ®

## 7. æ‰©å±•æ€§è®¾è®¡

### 7.1 æ’ä»¶ç³»ç»Ÿ
- **æ¨¡æ¿æ’ä»¶**: æ”¯æŒç¬¬ä¸‰æ–¹æ¨¡æ¿
- **åŠŸèƒ½æ’ä»¶**: æ”¯æŒåŠŸèƒ½æ‰©å±•
- **ä¸»é¢˜æ’ä»¶**: æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜

### 7.2 APIæ¥å£
- **RESTful API**: æä¾›å®Œæ•´çš„APIæ¥å£
- **Webhook**: æ”¯æŒäº‹ä»¶é€šçŸ¥
- **SDK**: æä¾›å¼€å‘SDK

### 7.3 Wordæ–‡æ¡£åŠŸèƒ½éš”ç¦»ä¸å¯ç»´æŠ¤æ€§
- Wordæ–‡æ¡£ç›¸å…³åŠŸèƒ½ï¼ˆè§£æã€è½¬æ¢ã€å¯¼å‡ºç­‰ï¼‰å…¨éƒ¨å°è£…åœ¨ç‹¬ç«‹æ¨¡å—ï¼ˆå¦‚core/word_parser.pyï¼‰ä¸­ï¼Œä¸»ç¼–è¾‘å™¨é€šè¿‡æ¥å£è°ƒç”¨ã€‚
- Wordæ”¯æŒå¯é€šè¿‡é…ç½®å¼€å…³å¯ç”¨/ç¦ç”¨ï¼Œä¾¿äºåç»­ç»´æŠ¤å’Œå‡çº§ã€‚
- Wordæ¨¡å—çš„å¼‚å¸¸ã€æ€§èƒ½ç­‰é—®é¢˜ä¸ä¼šå½±å“ä¸»ç¼–è¾‘å™¨å’Œå…¶ä»–æ–‡æ¡£æ ¼å¼ã€‚
- æ”¯æŒåç»­æ‰©å±•æ›´å¤šWordç‰¹æ€§ï¼ˆå¦‚è¡¨æ ¼ã€å›¾ç‰‡ã€æ‰¹é‡è½¬æ¢ç­‰ï¼‰ï¼Œä¸å½±å“ä¸»æµç¨‹ã€‚

### 7.4 APIæœåŠ¡ç®¡ç†é›†æˆè®¾è®¡
- **æœåŠ¡æ§åˆ¶æ¥å£**: åœ¨ä¸»çª—å£ç•Œé¢é›†æˆAPIæœåŠ¡çš„å¯åŠ¨ã€åœæ­¢ã€é‡å¯åŠŸèƒ½
- **çŠ¶æ€ç›‘æ§ç³»ç»Ÿ**: å®æ—¶ç›‘æ§APIæœåŠ¡è¿è¡ŒçŠ¶æ€ï¼Œæä¾›å¥åº·æ£€æŸ¥å’Œæ•…éšœè¯Šæ–­
- **é…ç½®ç®¡ç†ç•Œé¢**: æ”¯æŒAPIæœåŠ¡åŸºç¡€é…ç½®çš„å›¾å½¢åŒ–ä¿®æ”¹ï¼ˆç«¯å£ã€åœ°å€ç­‰ï¼‰
- **è™šæ‹Ÿç¯å¢ƒæ”¯æŒ**: ç¡®ä¿APIæœåŠ¡åœ¨é¡¹ç›®è™šæ‹Ÿç¯å¢ƒä¸­æ­£ç¡®å¯åŠ¨å’Œè¿è¡Œ
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**: æä¾›ç›´è§‚çš„çŠ¶æ€æŒ‡ç¤ºã€æ“ä½œåé¦ˆå’Œé”™è¯¯æç¤º
- **å¼‚å¸¸å¤„ç†æœºåˆ¶**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ¢å¤å»ºè®®ï¼Œé™ä½ç”¨æˆ·ä½¿ç”¨é—¨æ§›

## 8. æµ‹è¯•ç­–ç•¥

### 8.1 å•å…ƒæµ‹è¯•
- **æ¨¡æ¿å¼•æ“æµ‹è¯•**: æµ‹è¯•æ¨¡æ¿æ¸²æŸ“
- **å˜é‡ç³»ç»Ÿæµ‹è¯•**: æµ‹è¯•å˜é‡å¤„ç†
- **é¢„è§ˆç³»ç»Ÿæµ‹è¯•**: æµ‹è¯•é¢„è§ˆåŠŸèƒ½

### 8.2 é›†æˆæµ‹è¯•
- **ç«¯åˆ°ç«¯æµ‹è¯•**: æµ‹è¯•å®Œæ•´æµç¨‹
- **æ€§èƒ½æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿæ€§èƒ½
- **å…¼å®¹æ€§æµ‹è¯•**: æµ‹è¯•å¹³å°å…¼å®¹æ€§

### 8.4 Wordæ–‡æ¡£æ”¯æŒä¸“é¡¹æµ‹è¯•
- Wordè§£æå™¨å•å…ƒæµ‹è¯•ï¼šä¸åŒç±»å‹Wordæ–‡æ¡£çš„è§£æã€è½¬æ¢ã€å¯¼å‡ºæ­£ç¡®æ€§
- Wordä¸Markdownäº’è½¬ä¸€è‡´æ€§æµ‹è¯•
- Wordå¤§çº²å¯¼èˆªä¸åªè¯»æ¨¡å¼æµ‹è¯•
- WordåŠŸèƒ½å¼‚å¸¸éš”ç¦»ä¸å›é€€æµ‹è¯•

## 9. éƒ¨ç½²æ–¹æ¡ˆ

### 9.1 å•æœºéƒ¨ç½²
- **æœ¬åœ°å®‰è£…**: æ”¯æŒæœ¬åœ°å®‰è£…ä½¿ç”¨
- **ä¾¿æºç‰ˆæœ¬**: æ”¯æŒä¾¿æºç‰ˆæœ¬
- **è‡ªåŠ¨æ›´æ–°**: æ”¯æŒè‡ªåŠ¨æ›´æ–°

### 9.2 å›¢é˜Ÿéƒ¨ç½²
- **æœåŠ¡å™¨éƒ¨ç½²**: æ”¯æŒå›¢é˜ŸæœåŠ¡å™¨éƒ¨ç½²
- **äº‘ç«¯éƒ¨ç½²**: æ”¯æŒäº‘ç«¯éƒ¨ç½²
- **å®¹å™¨åŒ–éƒ¨ç½²**: æ”¯æŒDockeréƒ¨ç½²

---

**æ ‡ç­¾**: `#æ¨¡æ¿ç®¡ç†` `#æ–‡æ¡£ç¼–è¾‘` `#PyQt6` `#å¯è§†åŒ–ç¼–è¾‘` `#AIå¢å¼º` `#åä½œç³»ç»Ÿ`
